<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="National Cyber Security Hackathon 2022 — Cryptography Write Up" /><meta name="author" content="wonderchild" /><meta property="og:locale" content="en" /><meta name="description" content="A blog to share my work and the things that catch my interest." /><meta property="og:description" content="A blog to share my work and the things that catch my interest." /><link rel="canonical" href="https://vonderchild.github.io/posts/National-Hackathon-2022/" /><meta property="og:url" content="https://vonderchild.github.io/posts/National-Hackathon-2022/" /><meta property="og:site_name" content="Saad Javed" /><meta property="og:image" content="https://vonderchild.github.io/assets/img/posts/hackathon-2022/meme.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-25T22:40:00+05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://vonderchild.github.io/assets/img/posts/hackathon-2022/meme.jpeg" /><meta property="twitter:title" content="National Cyber Security Hackathon 2022 — Cryptography Write Up" /><meta name="twitter:site" content="@vonderchild" /><meta name="twitter:creator" content="@wonderchild" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"wonderchild"},"dateModified":"2023-03-30T18:12:20+05:00","datePublished":"2022-12-25T22:40:00+05:00","description":"A blog to share my work and the things that catch my interest.","headline":"National Cyber Security Hackathon 2022 — Cryptography Write Up","image":"https://vonderchild.github.io/assets/img/posts/hackathon-2022/meme.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://vonderchild.github.io/posts/National-Hackathon-2022/"},"url":"https://vonderchild.github.io/posts/National-Hackathon-2022/"}</script><title>National Cyber Security Hackathon 2022 — Cryptography Write Up | Saad Javed</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Saad Javed"><meta name="application-name" content="Saad Javed"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Saad Javed</a></div><div class="site-subtitle font-italic">A security engineer with interests in cryptography, web security, cloud security, and digital forensics.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/vonderchild" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/vonderchild" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/saadjawayd" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['saadjawayd','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>National Cyber Security Hackathon 2022 — Cryptography Write Up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>National Cyber Security Hackathon 2022 — Cryptography Write Up</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/vonderchild">Saad Javed</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1671990000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-12-25 </em> </span> <span> Updated <em class="timeago" data-ts="1680181940" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-03-30 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5442 words"> <em>30 min</em> read</span></div></div></div><div class="post-content"><hr /><p>There’s a saying that gets thrown around a lot in the cybersecurity community, “Never roll your own crypto”, which refers to the idea that it is generally not recommended to create your own cryptographic algorithms or protocols, and instead to use established and well-vetted implementations.</p><p>In this writeup, let’s explore the solutions to the cryptography challenges from the National Cyber Security Hackathon 2022 and consider the reasons behind this saying and some common pitfalls to avoid when doing cryptography.</p><blockquote class="prompt-info"><div><p>Heads up, the code coming up might not be the prettiest. I’m a hacker first, then a software engineer, so when I’m trying to hack together a solution, aesthetics and best practices often take the backseat.</p></div></blockquote><p>So without further ado, let’s get started.</p><h1 id="extreme-ratio--karachi-qualifier">Extreme Ratio — Karachi Qualifier</h1><hr /><p>This challenge was classified as hard and was worth 200 points. The following source code was provided.</p><h3 id="source-code"><span class="mr-2">Source Code</span><a href="#source-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="challenge.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="n">gzip</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">ENCRYPT_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="n">FLAG</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'flag{*************************}'</span>

<span class="k">def</span> <span class="nf">encrypt_ctr</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">ctr</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">ENCRYPT_KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">counter</span><span class="o">=</span><span class="n">ctr</span><span class="p">)</span>
    <span class="n">ctxt</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ctxt</span>

<span class="k">def</span> <span class="nf">encrypt_ecb</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">ENCRYPT_KEY</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
    <span class="n">ctxt</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ctxt</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"(Compress|Encrypt)ion Service</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"Available Options: "</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"[0] Encryption Only (AES CTR)"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"[1] Encryption Only (AES ECB)"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"[2] Compression + Encryption:  (Gzip + AES CTR)"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"[3] Compression + Encryption:  (Gzip + AES ECB)"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">option</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"&gt;&gt; "</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">option</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">option</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Wrong Option"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"Error"</span><span class="p">)</span>
    <span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">ptxt_hex</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="s">"Data (hex encoded): "</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">ptxt_hex</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">ptxt</span> <span class="o">=</span> <span class="n">FLAG</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">ptxt_hex</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ctxt</span> <span class="o">=</span> <span class="nf">encrypt_ctr</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ctxt</span> <span class="o">=</span> <span class="nf">encrypt_ecb</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">ptxt</span> <span class="o">=</span> <span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>
        <span class="n">ctxt</span> <span class="o">=</span> <span class="nf">encrypt_ctr</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">ptxt</span> <span class="o">=</span> <span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>
        <span class="n">ctxt</span> <span class="o">=</span> <span class="nf">encrypt_ecb</span><span class="p">(</span><span class="n">ptxt</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">ctxt</span> <span class="o">+</span> <span class="nf">bytes</span><span class="p">([</span><span class="nf">len</span><span class="p">(</span><span class="n">ctxt</span><span class="p">)])</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">.</span><span class="nf">hex</span><span class="p">())</span>
</pre></table></code></div></div><h2 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The code is a simple command-line utility that provides four options:</p><ol><li>Encryption with AES in CTR mode<li>Encryption with AES in ECB mode<li>Compression with gzip followed by encryption with AES in CTR mode<li>Compression with gzip followed by encryption with AES in ECB mode</ol><p>The flag is declared at the start of the program along with the randomly generated AES key and IV/Counter. The user is prompted to select an option, and then to input data, which is concatenated with the flag and then encrypted according to the selected option. The result is then printed on the command line.</p><p>Initially, the code does not seem to be vulnerable, as it appears to use secure cryptographic practices such as generating random keys and IVs/Counters. However, upon a closer look, we find that the third and fourth options are modeled on the <a href="https://en.wikipedia.org/wiki/CRIME">CRIME</a> attack. I was familiar with this attack because I had previously come across and solved a similar problem and had read about the concept. Here’s what Wikipedia has to say about the attack:</p><blockquote><p><strong>CRIME</strong> (<strong>Compression Ratio Info-leak Made Easy</strong>) is a <a href="https://en.wikipedia.org/wiki/Security_vulnerability">security vulnerability</a> in <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> and <a href="https://en.wikipedia.org/wiki/SPDY">SPDY</a> protocols that utilize compression, which can leak the content of secret <a href="https://en.wikipedia.org/wiki/Web_cookie">web cookies</a>.<a href="https://en.wikipedia.org/wiki/CRIME#cite_note-fisher2012-09-13-1">[1]</a> When used to recover the content of secret <a href="https://en.wikipedia.org/wiki/Authentication_cookie">authentication cookies</a>, it allows an attacker to perform <a href="https://en.wikipedia.org/wiki/Session_hijacking">session hijacking</a> on an authenticated web session, allowing the launching of further attacks. CRIME was assigned <a href="https://en.wikipedia.org/wiki/CVE_(identifier)">CVE</a>-<a href="https://www.cve.org/CVERecord?id=CVE-2012-4929">2012-4929</a>.<a href="https://en.wikipedia.org/wiki/CRIME#cite_note-:0-2">[2]</a></p></blockquote><h2 id="proof-of-concept"><span class="mr-2">Proof of Concept</span><a href="#proof-of-concept" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Here’s how the attack works:</p><p>Say we compress three similar strings, <code class="language-plaintext highlighter-rouge">Hello World!</code>, <code class="language-plaintext highlighter-rouge">Hello Hello World!</code>, <code class="language-plaintext highlighter-rouge">Hello There World!</code></p><div class="language-python nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">gzip</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"Hello World!"</span><span class="p">))</span>
<span class="mi">32</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"Hello Hello World!"</span><span class="p">))</span>
<span class="mi">34</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"Hello There World!"</span><span class="p">))</span>
<span class="mi">38</span>
</pre></table></code></div></div><p>Notice the changes in lengths of compressed input strings? Well, that’s how compression works. It identifies repeating patterns in the input and replaces them with a smaller representation.</p><h3 id="explain-like-im-five"><span class="mr-2">Explain Like I’m Five</span><a href="#explain-like-im-five" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The first input string is <code class="language-plaintext highlighter-rouge">Hello World!</code>, which when compressed, is 32 bytes long. The second input string is <code class="language-plaintext highlighter-rouge">Hello Hello World!</code>, which has a slightly longer compressed representation (34 bytes) because it has more repeated characters. The third input string is <code class="language-plaintext highlighter-rouge">Hello There World!</code>, which has an even longer compressed representation (38 bytes) because it has fewer repeated characters and more unique characters. In short, the more repetition there is, the shorter the compressed representation will be. And that’s all we need to crack this challenge.</p><h2 id="the-attack"><span class="mr-2">The Attack</span><a href="#the-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We know that the flag value starts with <code class="language-plaintext highlighter-rouge">flag{</code>, and is likely made up of ASCII letters, digits, and special characters <code class="language-plaintext highlighter-rouge">_{}</code>. It’s also very likely that the flag will not consist of the <code class="language-plaintext highlighter-rouge">;</code> character. With that knowledge, we can begin the process of recovering the flag.</p><p>Here’s a step by step breakdown of the process:</p><ol><li>Create a payload by appending an <code class="language-plaintext highlighter-rouge">invalid_char</code> to the <code class="language-plaintext highlighter-rouge">flag</code> and multiplying the resulting string by <code class="language-plaintext highlighter-rouge">5</code> (this will ensure that the <code class="language-plaintext highlighter-rouge">len(ptxt_hex) &gt; 32</code> condition is satisfied).<li>Send the payload to the server and store the length of the response in a variable called <code class="language-plaintext highlighter-rouge">response_length</code>. (Refer to step 4 and you’ll realize why we’re only interested in length)<li>Repeat the process, but this time append each character that is likely to be in the flag to the <code class="language-plaintext highlighter-rouge">flag</code> instead of the <code class="language-plaintext highlighter-rouge">invalid_char</code>.<li><p>Compare the length of the current response to the initial <code class="language-plaintext highlighter-rouge">response_length</code>. If the length of the current response is smaller than the initial response, it means that the current character is likely to be part of the flag. This can be best explained by the following example:</p><div class="language-python nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> <span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"flag{test_flag}"</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"flag{;"</span><span class="p">))</span> <span class="c1"># invalid char
</span> <span class="mi">37</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"flag{test_flag}"</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"flag{t"</span><span class="p">))</span> <span class="c1"># correct char
</span> <span class="mi">36</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"flag{test_flag}"</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"flag{te"</span><span class="p">))</span> <span class="c1"># correct char
</span> <span class="mi">36</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="sa">b</span><span class="s">"flag{test_flag}"</span> <span class="o">+</span> <span class="sa">b</span><span class="s">"flag{test_flag}"</span><span class="p">))</span> <span class="c1"># correct char
</span> <span class="mi">36</span>
</pre></table></code></div></div><li>Add the current character to the <code class="language-plaintext highlighter-rouge">flag</code> value.<li>Repeat this process until the flag is fully recovered.</ol><h3 id="attack-code"><span class="mr-2">Attack Code</span><a href="#attack-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">string</span> <span class="kn">import</span> <span class="n">ascii_letters</span><span class="p">,</span> <span class="n">digits</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"flag{"</span> <span class="c1"># known partial flag
</span><span class="n">chars</span> <span class="o">=</span> <span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">digits</span> <span class="o">+</span> <span class="s">"_"</span> <span class="c1"># flag charset
</span><span class="n">invalid_char</span> <span class="o">=</span> <span class="s">';'</span> <span class="c1"># char that we know will not exist in the flag
</span>
<span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="s">'13.37.13.37'</span><span class="p">,</span> <span class="mi">1337</span><span class="p">)</span> <span class="c1"># make connection with the server
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"&gt;&gt;"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">"2"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"Data (hex encoded): "</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">(</span><span class="n">flag</span> <span class="o">+</span> <span class="n">invalid_char</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="c1"># craft payload with the invalid char willingly
</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">.</span><span class="nf">encode</span><span class="p">().</span><span class="nf">hex</span><span class="p">().</span><span class="nf">encode</span><span class="p">())</span> <span class="c1"># send payload
</span><span class="n">response</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">()</span> <span class="c1"># receive response
</span><span class="n">response_length</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="c1"># length of received reponse
</span>
<span class="n">known_flag</span> <span class="o">=</span> <span class="s">"flag{******************************}"</span> <span class="c1"># useful to calculate length
</span>
<span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">!=</span> <span class="nf">len</span><span class="p">(</span><span class="n">known_flag</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># loop till found flag &lt; actual flag
</span>    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span> <span class="c1"># try all chars
</span>        <span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"Data (hex encoded): "</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">((</span><span class="n">flag</span> <span class="o">+</span> <span class="n">char</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">).</span><span class="nf">encode</span><span class="p">().</span><span class="nf">hex</span><span class="p">().</span><span class="nf">encode</span><span class="p">()</span> <span class="c1"># append char with known flag
</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">()</span>

<span class="c1"># If length of current response is less than the response we received for invalid char,
# it means we have found the correct char for the current position.
# Append the char to the flag and continue.
</span>        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">response_length</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="n">char</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="k">break</span>

<span class="n">flag</span> <span class="o">+=</span> <span class="s">"}"</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>w㉿kali<span class="o">)</span>-[~]
└─<span class="nv">$ </span>python3 solve.py
flag<span class="o">{</span>c
flag<span class="o">{</span>co
flag<span class="o">{</span>com
flag<span class="o">{</span>comp
flag<span class="o">{</span>compr
flag<span class="o">{</span>compre
flag<span class="o">{</span>compres
flag<span class="o">{</span>compress
flag<span class="o">{</span>compressi
flag<span class="o">{</span>compressio
flag<span class="o">{</span>compression
flag<span class="o">{</span>compression_
flag<span class="o">{</span>compression_r
flag<span class="o">{</span>compression_ra
flag<span class="o">{</span>compression_rat
flag<span class="o">{</span>compression_rati
flag<span class="o">{</span>compression_ratio
flag<span class="o">{</span>compression_ratio_
flag<span class="o">{</span>compression_ratio_s
flag<span class="o">{</span>compression_ratio_si
flag<span class="o">{</span>compression_ratio_sid
flag<span class="o">{</span>compression_ratio_side
flag<span class="o">{</span>compression_ratio_side_
flag<span class="o">{</span>compression_ratio_side_c
flag<span class="o">{</span>compression_ratio_side_ch
flag<span class="o">{</span>compression_ratio_side_cha
flag<span class="o">{</span>compression_ratio_side_chan
flag<span class="o">{</span>compression_ratio_side_chann
flag<span class="o">{</span>compression_ratio_side_channe
flag<span class="o">{</span>compression_ratio_side_channel
flag<span class="o">{</span>compression_ratio_side_channel<span class="o">}</span>
</pre></table></code></div></div><p>It took me around 10 minutes to solve this challenge, and approximately two hours to write the explanation for the solution.</p><h1 id="weird--lahore-qualifier">Weird — Lahore Qualifier</h1><hr /><p>We’re provided with the following parameters for this challenge.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">p</span> <span class="o">=</span> <span class="mi">176023127217849634927507644091332103662520798054278045327249238656498565387166410134529055214072955585770692068345570429086751483097092606584061804212765484464710219858985411381151536676964148178819264599826409752010695119522361661128265187444633270601478731133478455869738783525606488878825620612673405443451</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">112223742839001528812998118414186973172817700984809834685105385564920931672517928021207242740576468083925973443165114290353820217347317026045854850099010720339559464915862999940561296479870088962751450854529450600985614397788176734730474800832462529288309338861856248732919840555336781231835349093136651776199</span>
<span class="n">dp</span> <span class="o">=</span> <span class="mi">30385087538855105185173631572543831910674493438359546631957370965394172444160714756294203320157155777516716569112588031576849314924796304802920730636229236548768238849909313008742374774478823911081516143430774367261518805277000586852931743778506123941097942991716525694686408217996359250833964223155034398849</span>
<span class="n">dq</span> <span class="o">=</span> <span class="mi">16565834851621714934943194340380561354378406645660464449478884583192424151732554179201902353804271636654563551379619523372168111644035752758829399035221380255914879788552481418444975048102550117169468808280550250275236324494363826390413993168761753803593832990575552156785084689157314624226120721693168527045</span>
<span class="n">ct</span> <span class="o">=</span> <span class="mi">12471250728278476973667997300089729054215534203191298445075721390063696581388107032026935036071214619926891164048897398168910187436274670469379883863773864404832345129175958512553655002601862046540235957444868738298616361692115344364105067726967540803482175683177928601460820055610057091618766365214386842148469007862547736382438539960143699747392070571106949826103889774269543672861821736945264589704316771379195593723822149690773183639123458879061206847327965981924555643367839051015699745254023361484614560953387636228877078592886198124833581947075581814292380432723836026412556502710472578640877967731483702882569</span>
</pre></table></code></div></div><h2 id="initial-analysis-1"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>From the <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm">Wikipedia page of RSA cryptosystem</a>, the presence of <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">q</code>, <code class="language-plaintext highlighter-rouge">dp</code>, <code class="language-plaintext highlighter-rouge">dq</code>, and <code class="language-plaintext highlighter-rouge">ct</code> is a strong indication that a variant of RSA with Chinese Remainder Theorem is used.</p><p>Normally, RSA can take a while to decrypt a ciphertext because it involves raising the ciphertext to the power of the private key modulo the modulus, which can be a pain with big numbers. But with CRT, we can make the whole process a lot faster by taking two modular exponentiations with smaller exponents and moduli. To use RSA with CRT, we have to generate our RSA key a certain way and have a few extra values on hand, like $dp$, $dq$, and $q_{inv}$. Then we can just plug those values in along with the ciphertext and boom, decryption happens a lot quicker.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Since we have all the necessary parameters, we can just follow the decryption process as described on the <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm">Wikipedia page</a>.</p>\[q_{inv} = q^{-1} \mod p\] \[m_1 = c^{d_P} \mod p\] \[m_2 = c^{d_Q} \mod q\] \[h = q_{inv}(m_1 - m_2) \pmod p\] \[m = m_2 + hq \pmod{pq}\]<p>I have implemented the following solution in Python</p><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">176023127217849634927507644091332103662520798054278045327249238656498565387166410134529055214072955585770692068345570429086751483097092606584061804212765484464710219858985411381151536676964148178819264599826409752010695119522361661128265187444633270601478731133478455869738783525606488878825620612673405443451</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">112223742839001528812998118414186973172817700984809834685105385564920931672517928021207242740576468083925973443165114290353820217347317026045854850099010720339559464915862999940561296479870088962751450854529450600985614397788176734730474800832462529288309338861856248732919840555336781231835349093136651776199</span>
<span class="n">dp</span> <span class="o">=</span> <span class="mi">30385087538855105185173631572543831910674493438359546631957370965394172444160714756294203320157155777516716569112588031576849314924796304802920730636229236548768238849909313008742374774478823911081516143430774367261518805277000586852931743778506123941097942991716525694686408217996359250833964223155034398849</span>
<span class="n">dq</span> <span class="o">=</span> <span class="mi">16565834851621714934943194340380561354378406645660464449478884583192424151732554179201902353804271636654563551379619523372168111644035752758829399035221380255914879788552481418444975048102550117169468808280550250275236324494363826390413993168761753803593832990575552156785084689157314624226120721693168527045</span>
<span class="n">ct</span> <span class="o">=</span> <span class="mi">12471250728278476973667997300089729054215534203191298445075721390063696581388107032026935036071214619926891164048897398168910187436274670469379883863773864404832345129175958512553655002601862046540235957444868738298616361692115344364105067726967540803482175683177928601460820055610057091618766365214386842148469007862547736382438539960143699747392070571106949826103889774269543672861821736945264589704316771379195593723822149690773183639123458879061206847327965981924555643367839051015699745254023361484614560953387636228877078592886198124833581947075581814292380432723836026412556502710472578640877967731483702882569</span>

<span class="n">q_inv</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">m1</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">dq</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">q_inv</span><span class="o">*</span><span class="p">(</span><span class="n">m1</span> <span class="o">-</span> <span class="n">m2</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">q</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</pre></table></code></div></div><p>When we run the code, we get the flag: <code class="language-plaintext highlighter-rouge">FLAG{Ch!n3z_R3m@!nd3r_the0r3m_!$_U$3d_W!th_RSA_!_}</code></p><h1 id="rsa-tricks--lahore-qualifier">RSA Tricks — Lahore Qualifier</h1><hr /><p>For this challenge, the source code and its output were both provided.</p><h3 id="source-code-1"><span class="mr-2">Source Code</span><a href="#source-code-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="challenge.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">bytes_to_long</span><span class="p">,</span> <span class="n">inverse</span>

<span class="n">flag</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"Flag{XXXXXXXXXXXXXXXXXX}"</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">d</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

<span class="n">my_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="n">keys</span> <span class="o">=</span> <span class="p">[(</span><span class="n">N</span><span class="p">,</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nf">print</span><span class="p">(</span><span class="s">"- My private key"</span><span class="p">,</span><span class="n">my_key</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"- keys"</span><span class="p">,</span><span class="n">keys</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">"- Encrypted DATA"</span><span class="p">,</span><span class="n">cipher</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="output"><span class="mr-2">Output</span><a href="#output" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="output.txt" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="output.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>- My private key (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 6687607858232036068102764628763869770365480322599654007055390473672368166120078970889731780497544904312162417086944174061956166089097159465136283083934145573266810680333793401383561399492464805933196541665940377169806871229249258898514253795798667416326565964700803909765395310435346968714809745195915667635297064990795636997497174353498801451968512519467684250340907454722122526744868301815309377979214139209924022710213407189093358499791347140504060386679433394906044887470451126139251537410999047504158074154840567036307276609901744175974470733352724690467371739007984796402241006187231818157691483372021327246081)
- keys [(18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 47041), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 43997), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 64327), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 61091), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 41333), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 43753), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 49297), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 60859), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 62549), (18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981, 61603)]
- Encrypted DATA 17645273145351275595525807073989050948965947318364568960587912808565753550868679400761129493639312107881718704399079296084071662498685695737565304759095440251260751277410423164152439238058543479248616726569219754716569949310088729774754396896206740072798713368055282255138359044165511083329692314841881710654928579684619972781423759855118466981710663456827148741309715289690086375657132843333725276700434878544086599889531450088127607426279698041000280210449286322740624514005407432190062616631972904127404246574154910765957984452167524351965862221718745754696108925882968967217857798769220085678518029334502303515802
</pre></table></code></div></div><h2 id="initial-analysis-2"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Initially, the program calculates all the stuff it needs to use RSA, like <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">q</code>, <code class="language-plaintext highlighter-rouge">N</code>, <code class="language-plaintext highlighter-rouge">phi</code>, <code class="language-plaintext highlighter-rouge">e</code>, and <code class="language-plaintext highlighter-rouge">d</code>. Then it calculates 10 public keys that all use the same <code class="language-plaintext highlighter-rouge">N</code>, but each has a different, randomly chosen value for <code class="language-plaintext highlighter-rouge">e</code>. After that, it loops through all 10 keys and uses each one to encrypt the flag sequentially, and then it prints out the private key, the 10 public keys, and the final encrypted flag.</p><h2 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The only missing piece to solve this challenge is the value for <code class="language-plaintext highlighter-rouge">phi</code>, which we will need to calculate the private keys for the 10 public keys. There’s no direct way to calculate <code class="language-plaintext highlighter-rouge">phi</code> with the given values. However, we can use <code class="language-plaintext highlighter-rouge">d</code> to calculate the values of prime factors <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">q</code>, and then use that to calculate <code class="language-plaintext highlighter-rouge">phi</code>.</p><p><a href="https://crypto.stackexchange.com/questions/62482/algorithm-to-factorize-n-given-n-e-d">This stack exchange</a> post discusses how to recover prime factors <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">q</code> using private exponent <code class="language-plaintext highlighter-rouge">d</code>. From there, we can proceed with the following calculation to calculate <code class="language-plaintext highlighter-rouge">phi</code></p>\[\phi(N) = (p - 1) \times (q - 1)\]<p>After that, we can calculate the private exponents for the 10 public keys using</p>\[d = e^{-1} \mod \phi(N)\]<p>The following implementation in python can be used for recovering <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">q</code> from <code class="language-plaintext highlighter-rouge">d</code> (I reused the code from <a href="https://ctftime.org/writeup/18177">here</a>) and then calculating <code class="language-plaintext highlighter-rouge">phi</code>. It can then be used to sequentially decrypt the ciphertext by looping through the keys in reversed order.</p><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">sympy</span> <span class="kn">import</span> <span class="n">nextprime</span>
<span class="kn">import</span> <span class="n">math</span>

<span class="n">keys</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">47041</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">43997</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">64327</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">61091</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">41333</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">43753</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">49297</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">60859</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">62549</span><span class="p">),</span> <span class="p">(</span><span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">61603</span><span class="p">)]</span>
<span class="n">my_key</span> <span class="o">=</span> <span class="mi">18909558900895372672156824811256265991045063590569226191232596663778841681897127254948673384177564949258183981733845039930038021269357172312824082512373461836016350485677617488414637304277231253190262393267785594036484291990305836587795696393789682736379072984234903176904595412028705422757031938515174955122139225813788578454554534920388492258873319280552513284340011592837218450406177853876475453942250479834504622472801073857140934073199654193170101024653069855430546354617875613752042483103556896551326630710625617338594124873967949453649106318872176809724548259100966707725474321152035379845934513208799372680981</span><span class="p">,</span> <span class="mi">6687607858232036068102764628763869770365480322599654007055390473672368166120078970889731780497544904312162417086944174061956166089097159465136283083934145573266810680333793401383561399492464805933196541665940377169806871229249258898514253795798667416326565964700803909765395310435346968714809745195915667635297064990795636997497174353498801451968512519467684250340907454722122526744868301815309377979214139209924022710213407189093358499791347140504060386679433394906044887470451126139251537410999047504158074154840567036307276609901744175974470733352724690467371739007984796402241006187231818157691483372021327246081</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">17645273145351275595525807073989050948965947318364568960587912808565753550868679400761129493639312107881718704399079296084071662498685695737565304759095440251260751277410423164152439238058543479248616726569219754716569949310088729774754396896206740072798713368055282255138359044165511083329692314841881710654928579684619972781423759855118466981710663456827148741309715289690086375657132843333725276700434878544086599889531450088127607426279698041000280210449286322740624514005407432190062616631972904127404246574154910765957984452167524351965862221718745754696108925882968967217857798769220085678518029334502303515802</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">my_key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">my_key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>


<span class="k">def</span> <span class="nf">find_prime_factors</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">k</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nf">nextprime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">while</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nf">nextprime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="nf">gcd</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>


<span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="nf">find_prime_factors</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">65537</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">n</span>

<span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">e2</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></table></code></div></div><p>When we run the code, it prints out the flag: <code class="language-plaintext highlighter-rouge">Flag{N0_M1stak3s_W1th_RSA}</code></p><h1 id="simple-rsa--peshawar-qualifier">Simple RSA — Peshawar Qualifier</h1><hr /><p>The following values were provided with the challenge.</p><div file="challenge.txt" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">n</span><span class="o">=</span><span class="mi">16147111734460800396004592670421468929337203190257626881606012921435838643682486839638969919126011524499609044486548371078702382995209772340989167246102495015107720926778322642181742667106589581285868164349155811160988904172418976556526686941401355790760512930187413129387612432578824982589943249726538251843134494371205312446417743116926422296053343015812167511415786346049084785782293317209821769860285282759086233935620489199236381431918736093892708407699240019615286528179061459943754101031540022336347845482100465143834304730276518967143705254840069157949656506425821092281518997158195127056924848015561721144141</span>
<span class="n">e</span><span class="o">=</span><span class="mi">5</span>
<span class="n">ct</span><span class="o">=</span><span class="mi">111558645679006394985384019922106344256390245431545304101942130922177467904633500612867289903603121371437773246170390092045034734209187474652129636135263800118498886868963176721482556951317449397588032806400411456314451471867958481146150654899999731639797463584634515914586016365684332024632542448233024172820905812188634527134114383199826766449312686149601042672866478590545407942592434984704530370917178774467061817245773716440844189325157951539629919700395694364926837338497933420304953156481808563506013769102906246159631644750831210893</span>
</pre></table></code></div></div><h2 id="initial-analysis-3"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In this challenge, we are given three values: <code class="language-plaintext highlighter-rouge">n</code>, <code class="language-plaintext highlighter-rouge">e</code>, and <code class="language-plaintext highlighter-rouge">ct</code>. These variables are commonly used in the RSA, with <code class="language-plaintext highlighter-rouge">n</code> being the modulus (product of two primes <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">q</code>), <code class="language-plaintext highlighter-rouge">e</code> being the public exponent, and <code class="language-plaintext highlighter-rouge">ct</code> being the result of the encryption.</p><h2 id="solution-2"><span class="mr-2">Solution</span><a href="#solution-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In RSA, <code class="language-plaintext highlighter-rouge">ct</code> is calculated using the equation</p>\[ct = pt^{e} \mod n\]<p>It is not practical to find the flag by factoring <code class="language-plaintext highlighter-rouge">n</code>, as it is too large. However, we can use the small value of <code class="language-plaintext highlighter-rouge">ct</code> to our advantage. A small value of <code class="language-plaintext highlighter-rouge">ct</code> indicates that the plaintext <code class="language-plaintext highlighter-rouge">pt</code> is also small, meaning that the value of $pt^e$ is unlikely to exceed the modulus <code class="language-plaintext highlighter-rouge">n</code>.</p><p>Mathematically, this would mean that</p>\[ct = pt^e\]<p>We have the values of <code class="language-plaintext highlighter-rouge">e</code> and <code class="language-plaintext highlighter-rouge">ct</code>. Using the above equation, we can find the value of <code class="language-plaintext highlighter-rouge">pt</code> by taking the $e_{th}$ root of <code class="language-plaintext highlighter-rouge">ct</code>.</p>\[pt = \sqrt[e]{ct}\]<p>The following code in Python can be used to do the heavy lifting and find the flag.</p><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">gmpy2</span> <span class="kn">import</span> <span class="n">iroot</span>

<span class="n">n</span><span class="o">=</span><span class="mi">16147111734460800396004592670421468929337203190257626881606012921435838643682486839638969919126011524499609044486548371078702382995209772340989167246102495015107720926778322642181742667106589581285868164349155811160988904172418976556526686941401355790760512930187413129387612432578824982589943249726538251843134494371205312446417743116926422296053343015812167511415786346049084785782293317209821769860285282759086233935620489199236381431918736093892708407699240019615286528179061459943754101031540022336347845482100465143834304730276518967143705254840069157949656506425821092281518997158195127056924848015561721144141</span>
<span class="n">e</span><span class="o">=</span><span class="mi">5</span>
<span class="n">ct</span><span class="o">=</span><span class="mi">111558645679006394985384019922106344256390245431545304101942130922177467904633500612867289903603121371437773246170390092045034734209187474652129636135263800118498886868963176721482556951317449397588032806400411456314451471867958481146150654899999731639797463584634515914586016365684332024632542448233024172820905812188634527134114383199826766449312686149601042672866478590545407942592434984704530370917178774467061817245773716440844189325157951539629919700395694364926837338497933420304953156481808563506013769102906246159631644750831210893</span>

<span class="n">pt</span> <span class="o">=</span> <span class="nf">iroot</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>
</pre></table></code></div></div><p>When we run the code, we get the flag: <code class="language-plaintext highlighter-rouge">FLAG{1_7h1nk_7h3_p4dd1n9_w4sn'7_l00n9_en0ugh}</code></p><h1 id="weird-rsa--islamabad-qualifier">Weird RSA — Islamabad Qualifier</h1><hr /><p>For this challenge, we are given the following values and a hint that suggests using the Tonelli-Shanks algorithm.</p><div file="challenge.txt" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">N</span> <span class="o">=</span> <span class="mi">139799611644152653629701760688199671817845996420960212837951252403071310661876297820375820252422246921626014752203411034874959269400969108775865662803612855844497453022528516710849383838452964627284555992534657432806346951988469594342508507343895146379695281224818693776589341387464488798959628214836525573161</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="n">ct</span> <span class="o">=</span> <span class="mi">109733767844983290765119503489592855170752849288516002088462366789671645002019127220142982310787191296062721220321128553167026956288213764125394547996572709867807285688611358568443800185355352482287419029004226687301106507157859735263440122827975982957716941358479236936850859685064250996530125453414484062042</span>
</pre></table></code></div></div><h2 id="initial-analysis-4"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>From the use of <code class="language-plaintext highlighter-rouge">N</code> and <code class="language-plaintext highlighter-rouge">e</code>, we can assume that the cryptosystem used is RSA.</p><p>The value of $e$ is $65536$, an even number. Another thing to notice is that $N$, which should have been composite, is actually a prime number.</p><p>At this point, my subconscious mind had already crafted the following solution</p>\[\because N \in\mathbb{P}\] \[\phi(N) = N - 1\] \[d = e^{-1} \mod \phi(N)\] \[pt = ct^{d} \mod N\]<p>After implementing the above in Python and failing to recover the flag, I realized that $e$ and $N - 1$ are both even numbers, and it is not a property of an even number to be coprime to another even number because they share a common factor of $2$.</p><p>This implies that $\gcd(e, \phi(N)) \neq 1$, which means that the usual $pt = ct^d \mod N$ formula of RSA for decryption will not work.</p><p>What will work instead is taking the square root modulo $N$.</p><h2 id="solution-3"><span class="mr-2">Solution</span><a href="#solution-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>At first glance, the solution might seem fairly simple; take $63556_{th}$ root of the ciphertext — which you’ll find to be computationally infeasible.</p><p>Another thing we can try is taking consecutive square roots modulo $N$ until we find the correct $65536_{th}$ root, which will be our plaintext. But mind you, this is not regular arithmetic we’re dealing with, taking square root is not the same as taking square root modulo an integer $N$, which we refer to as modular square root in modular arithmetic.</p><p>But what does it mean to take the square root modulo an integer $N$? To compute an integer $y$ such that</p>\[y^2 \equiv x \mod N\]<p>If we take $x = 3$ and $N = 13$, the modular square root will be $y = 4$</p>\[4^2 \equiv 3 \mod 13\] \[3 \equiv 16 \mod 13\]<p>The method described above involves trying different values of $y$ until the correct solution is found, which can be computationally infeasible when working with large integers, and that’s when the Tonelli-Shanks algorithm comes into play.</p><h3 id="tonelli-shanks"><span class="mr-2">Tonelli-Shanks</span><a href="#tonelli-shanks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The Tonelli-Shanks algorithm is a method for finding the modular square root of an integer $x$ modulo a prime $p$. In other words, it is a method for finding an integer $y$ such that</p>\[y^2 \equiv x \mod p\]<p>I will not go into the specifics of the Tonelli-Shanks algorithm, as it is a complex topic on its own. However, it is worth noting that the algorithm has a time complexity of $O(\log(p)^2)$.</p><h3 id="all-hail-sage"><span class="mr-2">All Hail Sage!</span><a href="#all-hail-sage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>SageMath has a built-in <code class="language-plaintext highlighter-rouge">square_root()</code> function that uses Tonelli-Shanks to find the modular square root. We can just recurse through consecutive square roots modulo $N$ until we find one that contains the flag.</p><div file="solve.sage" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.sage"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">find_roots</span><span class="p">(</span><span class="n">exponent</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">exponent</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s">"flag"</span> <span class="ow">in</span> <span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">^</span> <span class="p">((</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">sqrt1</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">square_root</span><span class="p">()</span>
    <span class="n">sqrt2</span> <span class="o">=</span> <span class="o">-</span><span class="n">sqrt1</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">find_roots</span><span class="p">(</span><span class="n">exponent</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sqrt1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="nf">find_roots</span><span class="p">(</span><span class="n">exponent</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sqrt2</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">139799611644152653629701760688199671817845996420960212837951252403071310661876297820375820252422246921626014752203411034874959269400969108775865662803612855844497453022528516710849383838452964627284555992534657432806346951988469594342508507343895146379695281224818693776589341387464488798959628214836525573161</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="n">ct</span> <span class="o">=</span> <span class="mi">109733767844983290765119503489592855170752849288516002088462366789671645002019127220142982310787191296062721220321128553167026956288213764125394547996572709867807285688611358568443800185355352482287419029004226687301106507157859735263440122827975982957716941358479236936850859685064250996530125453414484062042</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">find_roots</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nc">GF</span><span class="p">(</span><span class="n">N</span><span class="p">)(</span><span class="n">ct</span><span class="p">)))</span>
</pre></table></code></div></div><p>When we run the code, it prints out the flag: <code class="language-plaintext highlighter-rouge">flag{7h3_3xp0n3n7_5h0uld_b3_odd}</code></p><h1 id="wadding--islamabad-qualifier">Wadding — Islamabad Qualifier</h1><hr /><p>This was another hard challenge worth 200 points. The following source code was provided.</p><h3 id="source-code-2"><span class="mr-2">Source Code</span><a href="#source-code-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="challenge.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="n">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span> <span class="k">as</span> <span class="n">h</span><span class="p">,</span> <span class="n">unhexlify</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">flag</span> <span class="kn">import</span> <span class="n">FLAG</span>
<span class="kn">from</span> <span class="n">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="nb">exit</span>
<span class="kn">import</span> <span class="n">math</span>

<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">block_size</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="nf">urandom</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)</span>
<span class="n">SECRET_LENGTH</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">MAX_TRIES</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="nf">ceil</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">nb</span> <span class="o">*</span> <span class="n">BLOCK_SIZE</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">+</span> <span class="nf">bytes</span><span class="p">([</span><span class="n">val</span><span class="p">]</span> <span class="o">*</span> <span class="n">val</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="sa">b</span><span class="s">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nf">bytes</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">generate_secret</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="s">'0'</span><span class="p">),</span> <span class="nf">ord</span><span class="p">(</span><span class="s">'?'</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">length</span><span class="p">))</span>

<span class="n">SECRET</span> <span class="o">=</span> <span class="nf">generate_secret</span><span class="p">(</span><span class="n">SECRET_LENGTH</span><span class="p">)</span>
<span class="n">ENCRYPTED_SECRET</span> <span class="o">=</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">SECRET</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">():</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Plaintext (in hex): "</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Key (in hex): "</span><span class="p">))</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Ciphertext (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">ct</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">():</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Ciphertext (in hex): "</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Key (in hex): "</span><span class="p">))</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Plaintext (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">pt</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_flag</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Encrypted secret (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">ENCRYPTED_SECRET</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Secret (in hex): "</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">secret</span> <span class="o">==</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">ENCRYPTED_SECRET</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Flag: </span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Wrong answer!"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">exit</span><span class="p">,</span> <span class="n">encrypt</span><span class="p">,</span> <span class="n">decrypt</span><span class="p">,</span> <span class="n">get_flag</span><span class="p">]</span>
    <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Leak: </span><span class="si">{</span><span class="n">SECRET</span><span class="p">[</span><span class="n">SECRET_LENGTH</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">tries</span> <span class="o">&lt;</span> <span class="n">MAX_TRIES</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"1. Encrypt"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"2. Decrypt"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"3. Get flag"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"0. Exit"</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">choice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'1'</span><span class="p">,</span> <span class="s">'2'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'0'</span><span class="p">]:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="s">"&gt; "</span><span class="p">)</span>
        <span class="n">funcs</span><span class="p">[</span><span class="nf">int</span><span class="p">(</span><span class="n">choice</span><span class="p">)]()</span>
        <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></table></code></div></div><h2 id="initial-analysis-5"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>The code presents us with four options:</p><ol><li>Encryption with AES in ECB mode.<li>Decryption with AES in ECB mode.<li>Get Flag — try to recover the flag by providing the correct value of <code class="language-plaintext highlighter-rouge">SECRET</code><li>Exit the program.</ol><p>A leak of the last character of <code class="language-plaintext highlighter-rouge">SECRET</code> is provided, and we have up to <code class="language-plaintext highlighter-rouge">5000</code> tries to guess its remaining characters. If our input matches the value stored on the server, the flag will be printed.</p><p>The code implements its own functions for pad and un-pad, which seems a bit weird since Python already has those built-in with its <code class="language-plaintext highlighter-rouge">Crypto</code> library. Before we jump into analyzing the these functions, let’s consult ChatGPT to understand padding.</p><blockquote class="prompt-tip"><div><p>In the field of cryptography, it is often necessary to encrypt messages or other data using a specific block size. For example, a block cipher might require that the message be a multiple of <code class="language-plaintext highlighter-rouge">16</code> bytes in length. If the message is not a multiple of the block size, it must be padded to fit.</p><p>The <code class="language-plaintext highlighter-rouge">PKCS#7</code> padding scheme is a way to pad a message so that it is the correct size for a block cipher. It works by adding a certain number of padding bytes to the end of the message, where the value of each padding byte is equal to the number of padding bytes added. For example, if a message needs to be padded with <code class="language-plaintext highlighter-rouge">3</code> bytes to fit a block size of <code class="language-plaintext highlighter-rouge">16</code>, the <code class="language-plaintext highlighter-rouge">PKCS#7</code> padding would be the bytes <code class="language-plaintext highlighter-rouge">0x03 0x03 0x03</code>.</p><p>To remove the padding, the recipient of the message simply checks the value of the last byte and removes that many padding bytes from the end of the message. For example, if the last byte of the message is <code class="language-plaintext highlighter-rouge">0x03</code>, the recipient would remove the last three bytes of the message (<code class="language-plaintext highlighter-rouge">0x03 0x03 0x03</code>) to obtain the original unpadded message.</p><p>— ChatGPT</p></div></blockquote><blockquote><p>For example, if the last byte of the message is <code class="language-plaintext highlighter-rouge">0x03</code>, the recipient would remove the last three bytes of the message (<code class="language-plaintext highlighter-rouge">0x03 0x03 0x03</code>) to obtain the original unpadded message.</p></blockquote><p>Hmm. What if the message’s length is <code class="language-plaintext highlighter-rouge">32</code> and the last byte of the message is <code class="language-plaintext highlighter-rouge">31</code>?</p><p>In that case, the un-pad function would return only the first byte of the message, removing the last <code class="language-plaintext highlighter-rouge">31</code> bytes of the message when, in fact, <code class="language-plaintext highlighter-rouge">31</code> is not even a correct padding. The correct paddings are <code class="language-plaintext highlighter-rouge">0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF</code>. It looks like the un-pad function is missing a crucial check. It just removes the last <code class="language-plaintext highlighter-rouge">x</code> bytes without even verifying that padding was actually performed in the first place.</p><h2 id="solution-4"><span class="mr-2">Solution</span><a href="#solution-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Remember that we were presented with a leak of the last byte? We can use it to our advantage. We’ll need to run the program multiple times till the last byte is <code class="language-plaintext highlighter-rouge">63</code> which would mean that the program would un-pad <code class="language-plaintext highlighter-rouge">63</code> bytes from the <code class="language-plaintext highlighter-rouge">64</code> byte ciphertext, leaving us with just 1 byte to guess. This leaves us with a probability of $\frac{1}{256}$, which is very achievable.</p><p>I wrote the following implementation in Python.</p><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">io</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="s">'./chall.py'</span><span class="p">)</span>

    <span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"Leak: "</span><span class="p">)</span>
    <span class="n">leak</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">leak</span> <span class="o">==</span> <span class="mi">63</span><span class="p">:</span> <span class="c1"># leaves us with 1/256 possibilities
</span>        <span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;'</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">"3"</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
        
        <span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">((</span><span class="nf">hex</span><span class="p">(</span><span class="mi">54</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]).</span><span class="nf">encode</span><span class="p">())</span> <span class="c1"># taking our guess as 54 (36 in hex)
</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>

        <span class="k">if</span> <span class="sa">b</span><span class="s">"Wrong"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">io</span><span class="p">.</span><span class="nf">kill</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">kill</span><span class="p">()</span>
</pre></table></code></div></div><p>When we run the code, the flag is printed in $&lt; 2$ minutes.</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>w㉿kali<span class="o">)</span>-[~]
└─<span class="nv">$ </span>python3 solve.py
b<span class="s1">'Flag: flag{essence_precedes_existence}\n'</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note: I did not have the original flag, so I hardcoded my own for demonstration.</p></div></blockquote><h1 id="rookie--final-round">Rookie — Final Round</h1><hr /><p>Rookie was a hard challenge in final round and was worth 200 points. The following source code was provided.</p><h3 id="source-code-3"><span class="mr-2">Source Code</span><a href="#source-code-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="challenge.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="n">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span> <span class="k">as</span> <span class="n">h</span><span class="p">,</span> <span class="n">unhexlify</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<span class="kn">from</span> <span class="n">flag</span> <span class="kn">import</span> <span class="n">FLAG</span>
<span class="kn">from</span> <span class="n">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="nb">exit</span>

<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">block_size</span>

<span class="k">def</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">),</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">random_byte</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)):</span>
    <span class="nf">seed</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt_secret</span><span class="p">(</span><span class="n">secret</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="nf">bytes</span><span class="p">(</span><span class="nf">random_byte</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)),</span> <span class="n">secret</span><span class="p">)</span>

<span class="n">SECRET</span> <span class="o">=</span> <span class="nf">urandom</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="n">ENCRYPTED_SECRET</span> <span class="o">=</span> <span class="nf">encrypt_secret</span><span class="p">(</span><span class="n">SECRET</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">():</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Plaintext (in hex): "</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Key (in hex): "</span><span class="p">))</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Ciphertext (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">ct</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">():</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Ciphertext (in hex): "</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Key (in hex): "</span><span class="p">))</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Plaintext (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">pt</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_flag</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Encrypted secret (in hex): </span><span class="si">{</span><span class="nf">h</span><span class="p">(</span><span class="n">ENCRYPTED_SECRET</span><span class="p">).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="nf">u</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="s">"Secret (in hex): "</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">secret</span> <span class="o">==</span> <span class="n">SECRET</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Flag: </span><span class="si">{</span><span class="n">FLAG</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Wrong answer!"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">exit</span><span class="p">,</span> <span class="n">encrypt</span><span class="p">,</span> <span class="n">decrypt</span><span class="p">,</span> <span class="n">get_flag</span><span class="p">]</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"1. Encrypt"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"2. Decrypt"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"3. Get flag"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"0. Exit"</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">choice</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'1'</span><span class="p">,</span> <span class="s">'2'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'0'</span><span class="p">]:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="s">"&gt; "</span><span class="p">)</span>
        <span class="n">funcs</span><span class="p">[</span><span class="nf">int</span><span class="p">(</span><span class="n">choice</span><span class="p">)]()</span>
</pre></table></code></div></div><h2 id="initial-analysis-6"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge is very similar to <code class="language-plaintext highlighter-rouge">Wadding</code> from Islamabad qualifier with just two differences:</p><ol><li>The author patched the vulnerability in un-pad function and instead resorted to use the implementation that came built-in with the <code class="language-plaintext highlighter-rouge">Crypto</code> library.<li>A new function is added called <code class="language-plaintext highlighter-rouge">random_byte</code>.</ol><p>Let’s begin with analyzing <code class="language-plaintext highlighter-rouge">random_byte</code>. The function accepts a random byte string of length <code class="language-plaintext highlighter-rouge">16</code>. It then initializes a seed which takes input the random byte string setting a starting point for the <code class="language-plaintext highlighter-rouge">random()</code> function, which ensures that the random function generates the same sequence of random integers each time it’s starting point is the same.</p><p>The <code class="language-plaintext highlighter-rouge">encrypt_secret</code> function calls the <code class="language-plaintext highlighter-rouge">random_byte</code> function <code class="language-plaintext highlighter-rouge">16</code> times for generating a random key. At first glance, this fooled me to think that a random byte will be generated every <code class="language-plaintext highlighter-rouge">16</code> times the function is called. Instead, what actually happens is each time the function is called, a same random byte is generated.</p><div class="language-python nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">random_byte</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">)):</span>
<span class="p">...</span>     <span class="nf">seed</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="p">...</span>     <span class="k">return</span> <span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="nf">random_byte</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">126</span><span class="p">]</span>
</pre></table></code></div></div><p>This suggests that this function’s capability is limited to generating a combination of total 256 possible keys:</p><div class="language-plaintext nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
...
...
...
[253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253, 253]
[254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254]
[255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255]
</pre></table></code></div></div><h2 id="solution-5"><span class="mr-2">Solution</span><a href="#solution-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The idea is to brute-force the key from a total of 256 keys. However, we can not just send the keys to the server for decryption, because if the key is incorrect, the server will crash, and we’ll have to start again. A better way to solve this challenge would be to create a list of all possible keys, loop through them to find the correct key, then decrypt the secret and send it to the server. If our secret matches the one stored on the server, we’ll get the flag.</p><p>I wrote the following implementation in Python.</p><div file="solve.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solve.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>

<span class="k">def</span> <span class="nf">generate_all_keys</span><span class="p">():</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
        <span class="n">keys</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">bytes</span><span class="p">([</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">keys</span>

<span class="k">def</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">possible_keys</span> <span class="o">=</span> <span class="nf">generate_all_keys</span><span class="p">()</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="s">'./chall.py'</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">'&gt;'</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s">"3"</span><span class="p">)</span>

<span class="n">ct</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="s">": "</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">())</span>

<span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">possible_keys</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">secret</span> <span class="o">=</span> <span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
        <span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">secret</span><span class="p">.</span><span class="nf">hex</span><span class="p">().</span><span class="nf">encode</span><span class="p">())</span>

        <span class="nf">print</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">())</span>

        <span class="k">break</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></table></code></div></div><p>Running this program a few times, we’ll get the flag. (worked for me in $\leq 5$ tries)</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>w㉿kali<span class="o">)</span>-[~]
└─<span class="nv">$ </span>python3 solve.py
b<span class="s1">'Flag: flag{or_existence_precedes_essence?}\n'</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note: I did not have the original flag, so I hardcoded my own for demonstration.</p></div></blockquote><h1 id="abstract--final-round">Abstract — Final Round</h1><hr /><p>Abstract was a hard challenge worth 200 points. The following source code was provided.</p><h3 id="source-code-4"><span class="mr-2">Source Code</span><a href="#source-code-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div file="challenge.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="challenge.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">inverse</span><span class="p">,</span> <span class="n">bytes_to_long</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">math</span>

<span class="n">FLAG</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'flag{????????????????????}'</span>

<span class="k">def</span> <span class="nf">gen_key</span><span class="p">():</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">q</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">q</span> <span class="o">//</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">math</span><span class="p">.</span><span class="nf">gcd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="nf">inverse</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="nf">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">q</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">q</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
    <span class="k">return</span> <span class="n">e</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="nf">inverse</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span> <span class="o">%</span> <span class="n">g</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="n">public</span><span class="p">,</span> <span class="n">private</span> <span class="o">=</span> <span class="nf">gen_key</span><span class="p">()</span>
<span class="n">q</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">public</span>
<span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">private</span>

<span class="n">m</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Public key: </span><span class="si">{</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">h</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Encrypted Flag: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="a-tale-of-stolen-challenges"><span class="mr-2">A tale of stolen challenges</span><a href="#a-tale-of-stolen-challenges" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I will not do a write-up for this challenge, since this was a stolen challenge from <a href="https://cryptohack.org/challenges/maths/">CryptoHack’s Find the Lattice</a>. You may verify this by pasting the provided source code on google, the first returned result is the original source of this challenge. I spent around 2 hours during the competition trying to do the math for this challenge, and failed miserably. Meanwhile, almost every other team solved it by pasting the code on google and finding the solutions.</p><p>There’s you putting in an effort and time, trying to solve a challenge on your own, and then there are those who know that the solution is available on the internet. Is this not a waste of effort?</p><p>Feedbacks were shared with the organizers right after the online qualifying round (which also consisted of a <a href="https://exti0p.github.io/ctf/2021/FwordCTF/web/parrotox.html">stolen challenge from Fword CTF</a>), and yet they still did nothing to address the participants’ concerns. This is just one example. There were stolen and repeated challenges throughout the hackathon from the online qualifying round to the city qualifier rounds to the final round. I find it hard to understand how such sloppiness at a national level competition could go unnoticed.</p><h3 id="feedback-for-organizers"><span class="mr-2">Feedback for Organizers</span><a href="#feedback-for-organizers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>For future CTF competitions, it’s important for the organizers to do their homework and really understand what goes into creating a CTF. It takes a lot of research, planning, and creativity to come up with fresh ideas for challenges. It’s also important to check and double check that your challenges are actually solvable, making sure the platform is available throughout the whole competition, providing official write-ups after the CTF ends, and that you have a plan for when things go wrong (cheating/flag sharing). Organizers should consider reading <a href="https://docs.google.com/document/d/1QBhColOjT8vVeyQxM1qNE-pczqeNSJiWOEiZQF2SSh8/preview">this CTF guideline</a> to ensure that the competition runs smoothly and provides a meaningful and enjoyable experience for all participants.</p><h1 id="ending-note">Ending note</h1><hr /><p>To wrap things up, cryptography can be a lot of fun to work with, especially when you’re solving challenges like in a CTF. But it’s important to remember that real-world situations are a lot different, and it’s essential to use established, tried-and-true algorithms and libraries to keep your systems secure. I hope that the writeup has provided some insight into the process of dos and don’ts of cryptography and that you feel motivated to try your hand at some CTFs of your own. I’m happy to answer any questions you might have about the techniques discussed in this writeup, so feel free to reach out to me on <a href="http://twitter.com/vonderchild">twitter</a> or discord (wonderchild#3321).</p><p>That’s All Folks, Happy Hacking!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackathon/'>Hackathon</a>, <a href='/categories/crypto/'>Crypto</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a> <a href="/tags/hackathon/" class="post-tag no-text-decoration" >Hackathon</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=National Cyber Security Hackathon 2022 — Cryptography Write Up - Saad Javed&amp;url=https://vonderchild.github.io/posts/National-Hackathon-2022/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=National Cyber Security Hackathon 2022 — Cryptography Write Up - Saad Javed&amp;u=https://vonderchild.github.io/posts/National-Hackathon-2022/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://vonderchild.github.io/posts/National-Hackathon-2022/&amp;text=National Cyber Security Hackathon 2022 — Cryptography Write Up - Saad Javed" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DeconstruCT.F-Doe-A-Deer/">Doe, a deer — DeconstruCT.F 2021</a><li><a href="/posts/PCC-Crypto/">Pakistan Cyber Security Challenge CTF - Cryptography Write-Up</a><li><a href="/posts/National-Hackathon-2022/">National Cyber Security Hackathon 2022 — Cryptography Write Up</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/containers/">Containers</a> <a class="post-tag" href="/tags/hackathon/">Hackathon</a> <a class="post-tag" href="/tags/pcc/">PCC</a> <a class="post-tag" href="/tags/security/">Security</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PCC-Crypto/"><div class="card-body"> <em class="timeago small" data-ts="1659616200" > 2022-08-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pakistan Cyber Security Challenge CTF - Cryptography Write-Up</h3><div class="text-muted small"><p> Hello folks, recently I participated in the 1st Pakistan Cyber Security Challenge CTF. My team secured 1st position in the qualifying round and came in 2nd place in the final round held at Air Univ...</p></div></div></a></div><div class="card"> <a href="/posts/DeconstruCT.F-Doe-A-Deer/"><div class="card-body"> <em class="timeago small" data-ts="1633173600" > 2021-10-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Doe, a deer — DeconstruCT.F 2021</h3><div class="text-muted small"><p> Last week, my team and I took part in DeconstruCT.F, a 24-hour Capture The Flag event organized by the Google Developers Student Club at Vellore Institute of Technology. It was an exciting compet...</p></div></div></a></div><div class="card"> <a href="/posts/containers-running-as-root/"><div class="card-body"> <em class="timeago small" data-ts="1679823000" > 2023-03-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The False Sense of Security: Running Containers as root</h3><div class="text-muted small"><p> Containers have revolutionized modern software development, enabling us to develop, build, package, and deploy software applications faster and more efficiently than ever before. The benefits of ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/PCC-Crypto/" class="btn btn-outline-primary" prompt="Older"><p>Pakistan Cyber Security Challenge CTF - Cryptography Write-Up</p></a> <a href="/posts/containers-running-as-root/" class="btn btn-outline-primary" prompt="Newer"><p>The False Sense of Security: Running Containers as root</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/vonderchild">Saad Javed</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/containers/">Containers</a> <a class="post-tag" href="/tags/hackathon/">Hackathon</a> <a class="post-tag" href="/tags/pcc/">PCC</a> <a class="post-tag" href="/tags/security/">Security</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KY7H42WSKR"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KY7H42WSKR'); }); </script>
